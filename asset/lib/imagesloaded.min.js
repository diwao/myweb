(function(){function g(){}function h(b,a){for(var d=b.length;d--;)if(b[d].listener===a)return d;return-1}function e(b){return function(){return this[b].apply(this,arguments)}}var c=g.prototype,j=this,f=j.EventEmitter;c.getListeners=function(b){var a=this._getEvents(),d,i;if("object"===typeof b)for(i in d={},a)a.hasOwnProperty(i)&&b.test(i)&&(d[i]=a[i]);else d=a[b]||(a[b]=[]);return d};c.flattenListeners=function(b){var a=[],d;for(d=0;d<b.length;d+=1)a.push(b[d].listener);return a};c.getListenersAsObject=
function(b){var a=this.getListeners(b),d;a instanceof Array&&(d={},d[b]=a);return d||a};c.addListener=function(b,a){var d=this.getListenersAsObject(b),i="object"===typeof a,c;for(c in d)d.hasOwnProperty(c)&&-1===h(d[c],a)&&d[c].push(i?a:{listener:a,once:!1});return this};c.on=e("addListener");c.addOnceListener=function(b,a){return this.addListener(b,{listener:a,once:!0})};c.once=e("addOnceListener");c.defineEvent=function(b){this.getListeners(b);return this};c.defineEvents=function(b){for(var a=0;a<
b.length;a+=1)this.defineEvent(b[a]);return this};c.removeListener=function(b,a){var d=this.getListenersAsObject(b),c,f;for(f in d)d.hasOwnProperty(f)&&(c=h(d[f],a),-1!==c&&d[f].splice(c,1));return this};c.off=e("removeListener");c.addListeners=function(b,a){return this.manipulateListeners(!1,b,a)};c.removeListeners=function(b,a){return this.manipulateListeners(!0,b,a)};c.manipulateListeners=function(b,a,d){var c,f,e=b?this.removeListener:this.addListener,b=b?this.removeListeners:this.addListeners;
if("object"===typeof a&&!(a instanceof RegExp))for(c in a){if(a.hasOwnProperty(c)&&(f=a[c]))"function"===typeof f?e.call(this,c,f):b.call(this,c,f)}else for(c=d.length;c--;)e.call(this,a,d[c]);return this};c.removeEvent=function(b){var a=typeof b,d=this._getEvents(),c;if("string"===a)delete d[b];else if("object"===a)for(c in d)d.hasOwnProperty(c)&&b.test(c)&&delete d[c];else delete this._events;return this};c.removeAllListeners=e("removeEvent");c.emitEvent=function(b,a){var c=this.getListenersAsObject(b),
f,e,g,h;for(g in c)if(c.hasOwnProperty(g))for(e=c[g].length;e--;)f=c[g][e],!0===f.once&&this.removeListener(b,f.listener),h=f.listener.apply(this,a||[]),h===this._getOnceReturnValue()&&this.removeListener(b,f.listener);return this};c.trigger=e("emitEvent");c.emit=function(b){var a=Array.prototype.slice.call(arguments,1);return this.emitEvent(b,a)};c.setOnceReturnValue=function(b){this._onceReturnValue=b;return this};c._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:
!0};c._getEvents=function(){return this._events||(this._events={})};g.noConflict=function(){j.EventEmitter=f;return g};"function"===typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return g}):"object"===typeof module&&module.exports?module.exports=g:this.EventEmitter=g}).call(this);
(function(g){function h(c){var b=g.event;b.target=b.target||b.srcElement||c;return b}var e=document.documentElement,c=function(){};e.addEventListener?c=function(c,b,a){c.addEventListener(b,a,!1)}:e.attachEvent&&(c=function(c,b,a){c[b+a]=a.handleEvent?function(){var b=h(c);a.handleEvent.call(a,b)}:function(){var b=h(c);a.call(c,b)};c.attachEvent("on"+b,c[b+a])});var j=function(){};e.removeEventListener?j=function(c,b,a){c.removeEventListener(b,a,!1)}:e.detachEvent&&(j=function(c,b,a){c.detachEvent("on"+
b,c[b+a]);try{delete c[b+a]}catch(d){c[b+a]=void 0}});e={bind:c,unbind:j};"function"===typeof define&&define.amd?define("eventie/eventie",e):g.eventie=e})(this);
(function(g,h){"function"===typeof define&&define.amd?define(["eventEmitter/EventEmitter","eventie/eventie"],function(e,c){return h(g,e,c)}):"object"===typeof exports?module.exports=h(g,require("eventEmitter"),require("eventie")):g.imagesLoaded=h(g,g.EventEmitter,g.eventie)})(this,function(g,h,e){function c(c,b){for(var a in b)c[a]=b[a];return c}function j(c){var b=[];if("[object Array]"===m.call(c))b=c;else if("number"===typeof c.length)for(var a=0,d=c.length;a<d;a++)b.push(c[a]);else b.push(c);
return b}function f(b,a,e){if(!(this instanceof f))return new f(b,a);"string"===typeof b&&(b=document.querySelectorAll(b));this.elements=j(b);this.options=c({},this.options);"function"===typeof a?e=a:c(this.options,a);if(e)this.on("always",e);this.getImages();if(d)this.jqDeferred=new d.Deferred;var g=this;setTimeout(function(){g.check()})}function b(b){this.img=b}function a(b){this.src=b;k[b]=this}var d=g.jQuery,i=g.console,l="undefined"!==typeof i,m=Object.prototype.toString;f.prototype=new h;f.prototype.options=
{};f.prototype.getImages=function(){this.images=[];for(var b=0,c=this.elements.length;b<c;b++){var a=this.elements[b];"IMG"===a.nodeName&&this.addImage(a);for(var a=a.querySelectorAll("img"),d=0,e=a.length;d<e;d++)this.addImage(a[d])}};f.prototype.addImage=function(a){this.images.push(new b(a))};f.prototype.check=function(){function b(e,f){a.options.debug&&l&&i.log("confirm",e,f);a.progress(e);c++;c===d&&a.complete();return!0}var a=this,c=0,d=this.images.length;this.hasAnyBroken=!1;if(d)for(var e=
0;e<d;e++){var f=this.images[e];f.on("confirm",b);f.check()}else this.complete()};f.prototype.progress=function(b){this.hasAnyBroken=this.hasAnyBroken||!b.isLoaded;var a=this;setTimeout(function(){a.emit("progress",a,b);a.jqDeferred&&a.jqDeferred.notify&&a.jqDeferred.notify(a,b)})};f.prototype.complete=function(){var b=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var a=this;setTimeout(function(){a.emit(b,a);a.emit("always",a);if(a.jqDeferred)a.jqDeferred[a.hasAnyBroken?"reject":"resolve"](a)})};
if(d)d.fn.imagesLoaded=function(a,b){return(new f(this,a,b)).jqDeferred.promise(d(this))};b.prototype=new h;b.prototype.check=function(){var b=k[this.img.src]||new a(this.img.src);if(b.isConfirmed)this.confirm(b.isLoaded,"cached was confirmed");else if(this.img.complete&&void 0!==this.img.naturalWidth)this.confirm(0!==this.img.naturalWidth,"naturalWidth");else{var c=this;b.on("confirm",function(a,b){c.confirm(a.isLoaded,b);return!0});b.check()}};b.prototype.confirm=function(a,b){this.isLoaded=a;this.emit("confirm",
this,b)};var k={};a.prototype=new h;a.prototype.check=function(){if(!this.isChecked){var a=new Image;e.bind(a,"load",this);e.bind(a,"error",this);a.src=this.src;this.isChecked=!0}};a.prototype.handleEvent=function(a){var b="on"+a.type;if(this[b])this[b](a)};a.prototype.onload=function(a){this.confirm(!0,"onload");this.unbindProxyEvents(a)};a.prototype.onerror=function(a){this.confirm(!1,"onerror");this.unbindProxyEvents(a)};a.prototype.confirm=function(a,b){this.isConfirmed=!0;this.isLoaded=a;this.emit("confirm",
this,b)};a.prototype.unbindProxyEvents=function(a){e.unbind(a.target,"load",this);e.unbind(a.target,"error",this)};return f});
